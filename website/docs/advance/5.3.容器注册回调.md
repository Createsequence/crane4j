## 容器注册回调

参照 Spring 的生命周期回调机制，`crane4j` 也提供了特殊的回调接口 `ContainerRegisterAware`，它提供两个方法用于干涉一般容器的注册行为：

- `beforeContainerRegister`：容器注册前回调，通过该方法可以替换掉最终要注册的容器示例；
- `afterContainerRegister`：容器注册后回调，通过该方法可以获取被注册的容器以及执行注册操作的 `ContainerProvider`；

`crane4j` 默认提供了两个回调实现：

- `DefaultCacheableContainerProcessor`：在用户的容器注册前，将会把要注册的容器对象包装并替换具备缓存功能的增强容器；
- `ContainerRegisterLogger`：在容器注册后，输出注册信息；

用户也可以自己实现 `ContainerRegisterAware`，并将其声明在 spring 上下文中以便自动注册，或者获得全局配置类 `Crane4jGlobalConfiguration` 后，调用 `addContainerRegisterAware` 方法手动注册。

:::warning

- `beforeContainerRegister`  方法执行后，若返回 `null` 将导致容器的注册行为被取消，但在部分容器提供者中会导致报错，因此一般情况下最好不要让一个 `ContainerRegisterAware` 有机会返回 `null`；
- 如果用户自定义了 `ContainerProvider` 默认是不会被感知到的，就像 spring 的后处理器不会处理 `FactoryBean` 生成的 `bean` 一样，若有必要，用户需要手动的向 `ContainerProvider` 注册回调接口；

:::
