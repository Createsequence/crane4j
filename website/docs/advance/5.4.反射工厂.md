## 反射工厂

在 `crane4j` 中，提供了属性操作者 `PropertyOperator` 组件，类似于 MyBatis 的反射工厂，用于统一管理框架各处的反射调用操作。

它被用于支持包括装配操作执行器、拆卸操作执行器、方法数据源容器以及自动填充切面中的各种属性操作功能。

默认情况下，`PropertyOperator` 提供了五个实现：

- `ReflectivePropertyOperator`：基于原生反射的普通反射属性操作者；
- `AsmReflectivePropertyOperator`：基于 `ReflectAsm` 的字节码反射属性操作者；
- `CacheablePropertyOperator`：装饰器，在原有功能的基础上支持 `getter` 和 `setter` 缓存；
- `MapAccessiblePropertyOperator`：装饰器，在原有功能的基础上支持读写 `Map` 集合；
- `ChainAccessiblePropertyOperator`：装饰器，在原有功能的基础上支持通过链式操作符读写嵌套对象属性；

如果你想替换默认的 `PropertyOperator` 实现，可以在 Spring 配置类中重新声明一个 `PropertyOperator`，并返回自定义的实现：

```java
@Bean
public PropertyOperator customPropertyOperator() {
    return new CustomPropertyOperator();
}
```

如果在非 Spring 环境中，可以获取全局配置对象 `Crane4jGlobalConfiguration` 并手动配置自定义的 `PropertyOperator`：

```java
SimpleCrane4jGlobalConfiguration configuration = SimpleCrane4jGlobalConfiguration.create();
configuration.setPropertyOperator(new CustomPropertyOperator());
```

另外，如果你希望对现有的 `PropertyOperator` 进行增强，例如支持读写 `Map` 集合或通过链式操作符读写嵌套对象属性，可以使用默认提供的包装类对属性操作者进行包装：

```java
PropertyOperator operator = new CustomPropertyOperator();
operator = new MapAccessiblePropertyOperator(operator);
operator = new ChainAccessiblePropertyOperator(operator);
```

请注意，包装时的顺序很重要，需要根据你的需求和使用情况选择正确的顺序。