## 一对多装配

<img src="https://img.xiajibagao.top/image-20230320105459223.png" alt="image-20230320105459223" style="zoom: 33%;" />

一对多，即一次操作中一个 key 属性对应到多个数据源对象，实际场景一般为从数据源容器中根据查询数据时，一个 key 可以查出一个集合或数组的情况。

比如，我们有一个 `customer` 容器，支持根据客户 id 查询客户，并且返回按客户组别 id 分组的 `Map` 集合：

~~~java
// 根据 id 查询客户，返回的数据按客户组别 id 
Container<String> customerContainer = LambdaContainer.forLambda(
	"customer", ids -> customerService.listByIds(ids).stream().collect(Collectors.groupBy(CustomerDO::getGroupId))
);
~~~

现在，我们可以借助一对多装配处理器批量的将数据源对象的属性提取为集合，在赋值给目标对象的指定属性：

~~~java
public class CustomerVO {
    @Assemble(
        container = "customer", handler = OneToManyReflexAssembleOperationHandler.class,
        props = @Mapping(src = "name", ref = "customerNames"),
        handlerName = "oneToManyAssembleOperationHandler"
    )
    private Integer id;
    private List<String> custmoerNames;
}
~~~

比如上述示例，就是根据 id 集合获得按客户组别 id 分组的客户集合后，提取 `CustomerDO.name` 组装为集合后赋值 `CustomerVO.custmoerNames`。

:::tip

关于一对多情况下的属性映射，请参见配置字段映射一节

:::
