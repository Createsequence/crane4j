## 概述

![image-20230311184930927](https://img.xiajibagao.top/image-20230311184930927.png)

容器提供者 `ContainerProvider` 是用于获取数据源容器的组件，类似 spring 中的 `FactoryBean`。

当我们通过提供者获取容器时，容器可能是已经提前注册好的，比如 `Crane4j` 的全局配置类 `Crane4jGlobalConfiguration`，又或者是动态生成的，比如 `crane4j-extension-mybatis-plus` 插件提供的 `MpMethodContainerProvider`。

## 注册

若有需要，用户可以实现 `ContainerProvider` 接口，并将其声明至 spring 上下文，该提供者将会自动注册到全局配置。

或者在非 spring 环境中，也可以在拿到全局配置类 `Crane4jGlobalConfiguration` 后进行手动注册：

~~~java
// 从 spring 容器中获取 Crane4jApplicationContext 实例
SimpleCrane4jGlobalConfiguration configuration = SimpleCrane4jGlobalConfiguration.create();
configuration.getContainerProviderMap().put("xxxContainerProvider", xxxContainerProvider);
~~~

## 使用

用户可通过 `@Assemble` 注解的 `containerProvider` 或 `containerProviderName` 属性指定该装配操作的容器从哪个提供者获取，比如：

~~~java
public class UserVO {
    @Assemble(
        container = "user", containerProvider = FooProvider.class,
        props = @Mapping(src = "name", ref = "name")
    )
    private Integer id;
    private String name;
}
~~~

当配置解析时，`crane4j` 将从用户指定的 `fooProvider` 获取 `namespace` 为 `user` 的数据源容器。
