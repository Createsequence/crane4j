<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>什么是 crane4j？ | Crane4j</title>
    <meta name="generator" content="VuePress 1.9.8">
    <link rel="icon" href="CRANE4J_ICON.png">
    <meta name="description" content="Crane4j, 基于注解的数据关联框架">
    
    <link rel="preload" href="/crane4j/assets/css/0.styles.31019e08.css" as="style"><link rel="preload" href="/crane4j/assets/js/app.431d2ea9.js" as="script"><link rel="preload" href="/crane4j/assets/js/2.c1e52383.js" as="script"><link rel="preload" href="/crane4j/assets/js/8.f25e37d4.js" as="script"><link rel="prefetch" href="/crane4j/assets/js/10.af580e3c.js"><link rel="prefetch" href="/crane4j/assets/js/11.ded82f7d.js"><link rel="prefetch" href="/crane4j/assets/js/12.58ccb414.js"><link rel="prefetch" href="/crane4j/assets/js/13.d634fc8b.js"><link rel="prefetch" href="/crane4j/assets/js/14.0eb6f7a0.js"><link rel="prefetch" href="/crane4j/assets/js/15.6f8f8a3f.js"><link rel="prefetch" href="/crane4j/assets/js/16.53915357.js"><link rel="prefetch" href="/crane4j/assets/js/17.dc1b0c0b.js"><link rel="prefetch" href="/crane4j/assets/js/18.a602e46b.js"><link rel="prefetch" href="/crane4j/assets/js/19.e281ff19.js"><link rel="prefetch" href="/crane4j/assets/js/20.d4494def.js"><link rel="prefetch" href="/crane4j/assets/js/21.ddde441a.js"><link rel="prefetch" href="/crane4j/assets/js/22.afad1638.js"><link rel="prefetch" href="/crane4j/assets/js/23.1c6da11e.js"><link rel="prefetch" href="/crane4j/assets/js/24.5f53ecff.js"><link rel="prefetch" href="/crane4j/assets/js/25.14583d06.js"><link rel="prefetch" href="/crane4j/assets/js/26.3f566b67.js"><link rel="prefetch" href="/crane4j/assets/js/27.de784ccd.js"><link rel="prefetch" href="/crane4j/assets/js/28.d4bf320a.js"><link rel="prefetch" href="/crane4j/assets/js/29.485a0ee3.js"><link rel="prefetch" href="/crane4j/assets/js/3.18fa7793.js"><link rel="prefetch" href="/crane4j/assets/js/30.eb3b6532.js"><link rel="prefetch" href="/crane4j/assets/js/31.9c1cca5a.js"><link rel="prefetch" href="/crane4j/assets/js/32.615a9cab.js"><link rel="prefetch" href="/crane4j/assets/js/33.a12407e0.js"><link rel="prefetch" href="/crane4j/assets/js/34.244aaa37.js"><link rel="prefetch" href="/crane4j/assets/js/35.3d1e65a4.js"><link rel="prefetch" href="/crane4j/assets/js/36.3f184666.js"><link rel="prefetch" href="/crane4j/assets/js/37.fa2a737a.js"><link rel="prefetch" href="/crane4j/assets/js/38.771f8ebb.js"><link rel="prefetch" href="/crane4j/assets/js/39.527c36b6.js"><link rel="prefetch" href="/crane4j/assets/js/4.53fb45c0.js"><link rel="prefetch" href="/crane4j/assets/js/40.ab5cac50.js"><link rel="prefetch" href="/crane4j/assets/js/41.7c18ec0a.js"><link rel="prefetch" href="/crane4j/assets/js/42.34114fbc.js"><link rel="prefetch" href="/crane4j/assets/js/43.221c5e4b.js"><link rel="prefetch" href="/crane4j/assets/js/44.7cb4ee42.js"><link rel="prefetch" href="/crane4j/assets/js/45.7a098971.js"><link rel="prefetch" href="/crane4j/assets/js/46.e25df290.js"><link rel="prefetch" href="/crane4j/assets/js/47.08c8b783.js"><link rel="prefetch" href="/crane4j/assets/js/48.00cd416f.js"><link rel="prefetch" href="/crane4j/assets/js/49.1615196e.js"><link rel="prefetch" href="/crane4j/assets/js/5.904b8d25.js"><link rel="prefetch" href="/crane4j/assets/js/6.c2306798.js"><link rel="prefetch" href="/crane4j/assets/js/7.cf446b63.js"><link rel="prefetch" href="/crane4j/assets/js/9.65d4d6f9.js">
    <link rel="stylesheet" href="/crane4j/assets/css/0.styles.31019e08.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/crane4j/" class="home-link router-link-active"><!----> <span class="site-name">Crane4j</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/crane4j/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="源码" class="dropdown-title"><span class="title">源码</span> <span class="arrow down"></span></button> <button type="button" aria-label="源码" class="mobile-dropdown-title"><span class="title">源码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/opengoofy/crane4j" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/CreateSequence/crane4j" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于作者" class="dropdown-title"><span class="title">关于作者</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于作者" class="mobile-dropdown-title"><span class="title">关于作者</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Createsequence/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/CreateSequence" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.xiajibagao.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/opengoofy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  关于我们
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/crane4j/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="源码" class="dropdown-title"><span class="title">源码</span> <span class="arrow down"></span></button> <button type="button" aria-label="源码" class="mobile-dropdown-title"><span class="title">源码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/opengoofy/crane4j" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/CreateSequence/crane4j" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于作者" class="dropdown-title"><span class="title">关于作者</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于作者" class="mobile-dropdown-title"><span class="title">关于作者</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Createsequence/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/CreateSequence" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.xiajibagao.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/opengoofy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  关于我们
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>指南</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/crane4j/user_guide/what_is_crane4j.html" aria-current="page" class="active sidebar-link">简介</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/crane4j/user_guide/what_is_crane4j.html#_1-什么是字段填充" class="sidebar-link">1.什么是字段填充？</a></li><li class="sidebar-sub-header"><a href="/crane4j/user_guide/what_is_crane4j.html#_2-用-crane4j-怎么做" class="sidebar-link">2.用 crane4j 怎么做？</a></li><li class="sidebar-sub-header"><a href="/crane4j/user_guide/what_is_crane4j.html#_3-为什么需要-crane4j" class="sidebar-link">3.为什么需要 crane4j？</a></li><li class="sidebar-sub-header"><a href="/crane4j/user_guide/what_is_crane4j.html#_4-如何开始使用" class="sidebar-link">4.如何开始使用？</a></li></ul></li><li><a href="/crane4j/user_guide/basic_concept.html" class="sidebar-link">基本概念</a></li><li><a href="/crane4j/user_guide/operational_principle.html" class="sidebar-link">原理</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/crane4j/user_guide/getting_started/getting_started_abstract.html" class="sidebar-heading clickable"><span>快速开始</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>场景示例</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/crane4j/user_guide/faq.html" class="sidebar-link">常见问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/crane4j/basic/declare_assemble_operation.html" class="sidebar-link">声明装配操作</a></li><li><a href="/crane4j/basic/property_mapping.html" class="sidebar-link">配置属性映射</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/crane4j/basic/container/container_abstract.html" class="sidebar-heading clickable"><span>数据源容器</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/crane4j/basic/trigger_operation.html" class="sidebar-link">触发填充操作</a></li><li><a href="/crane4j/basic/declare_disassemble_operation.html" class="sidebar-link">填充嵌套对象</a></li><li><a href="/crane4j/basic/assemble_operation_handler.html" class="sidebar-link">一对多&amp;多对多</a></li><li><a href="/crane4j/basic/operation_group.html" class="sidebar-link">分组填充</a></li><li><a href="/crane4j/basic/operation_sort.html" class="sidebar-link">顺序填充</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/crane4j/advanced/cache.html" class="sidebar-link">缓存</a></li><li><a href="/crane4j/advanced/combination_annotation.html" class="sidebar-link">组合注解</a></li><li><a href="/crane4j/advanced/callback_of_component.html" class="sidebar-link">组件的回调接口</a></li><li><a href="/crane4j/advanced/operation_annotation_handler.html" class="sidebar-link">注解处理器</a></li><li><a href="/crane4j/advanced/operator_interface.html" class="sidebar-link">使用抽象方法填充</a></li><li><a href="/crane4j/advanced/reflection_factory.html" class="sidebar-link">反射工厂</a></li><li><a href="/crane4j/advanced/type_converter.html" class="sidebar-link">类型转换</a></li><li><a href="/crane4j/advanced/async_executor.html" class="sidebar-link">异步填充</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>扩展插件</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/crane4j/extension/mybatis_plus_extension.html" class="sidebar-link">MybatisPlus</a></li><li><a href="/crane4j/extension/jackson_extension.html" class="sidebar-link">Jackson</a></li><li><a href="/crane4j/extension/redis_extension.html" class="sidebar-link">Redis</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/crane4j/other/configuration_properties.html" class="sidebar-link">配置文件</a></li><li><a href="/crane4j/other/changelog.html" class="sidebar-link">更新日志</a></li><li><a href="/crane4j/other/community.html" class="sidebar-link">联系作者</a></li><li><a href="/crane4j/other/How-To-Ask-Questions-The-Smart-Way.html" class="sidebar-link">提问的智慧</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="什么是-crane4j"><a href="#什么是-crane4j" class="header-anchor">#</a> 什么是 crane4j？</h1> <p><img src="/crane4j/assets/img/image-20230220150040070.63150c20.png" alt=""></p> <p><strong>crane4j 是一个基于注解的，用于完成一切 “根据 A 的 key 值拿到 B，再把 B 的属性映射到 A” 这类需求的字段填充框架。</strong></p> <p>最初，我在公司开发中遇到了大量重复的字段填充需求，这些需求与核心业务无关，只是一些重复的关联查询操作。我厌倦了频繁的联查和手动赋值，于是花了时间写一个小插件，用于自动查询接口并填充字段值。</p> <p>随着时间推移，这个插件功能逐渐丰富，我还加入了对枚举和常量的转换支持，并实现了基于切面的自动填充功能。最终，这个插件发展成了一个独立的内部框架，并在生产环境中广泛使用。</p> <p>在 2022 年初，我对这个内部框架进行了重构，并将其上传到 <code>Gitee</code>，它就是 <a href="https://github.com/Createsequence/crane" target="_blank" rel="noopener noreferrer"><code>crane</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。经过半年多的更新，<code>crane</code> 的功能逐渐稳定，但早期设计的不足导致扩展困难。因此，我重新梳理了功能，并决定在保留 <code>crane</code> 功能和概念的基础上进行彻底的重构，这就是现在的 <code>crane4j</code>。</p> <h2 id="_1-什么是字段填充"><a href="#_1-什么是字段填充" class="header-anchor">#</a> 1.什么是字段填充？</h2> <p>在日常开发中，从缓存或 DB 中查到的数据一般不直接具备所有字段，因此我们往往需要通过外键从各种数据源中 —— 比如 RPC 接口、枚举、字典或者 DB —— <strong>根据外检查询出各种关联信息</strong>，并将其部分字段填充到最终返回的对象上，这种行为实际上就是<strong>字段填充</strong>，或者也可以叫做数据组装或者数据聚合。</p> <p>我们以一个典型的“将字典编码转为字典值”为例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> <span class="token function">listPerson</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> ids<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1、根据 id 查询 person 数据</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Preson</span><span class="token punctuation">&gt;</span></span> persions <span class="token operator">=</span> personMapper<span class="token punctuation">.</span><span class="token function">listByIds</span><span class="token punctuation">(</span>ids<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 2、将性别枚举按编码分组</span>
    <span class="token comment">// {key = 0, value = GenderEnum.FEMALE}, {key = 1, value = GenderEnum.MALE}</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">GenderEnum</span><span class="token punctuation">&gt;</span></span> genderMap <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">GenderEnum</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span><span class="token class-name">GenderEnum</span><span class="token operator">::</span><span class="token function">getCode</span><span class="token punctuation">,</span> e <span class="token operator">-&gt;</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 3、根据 person 对象中的性别编码，为其设置对应的性别值</span>
    persions<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>person <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">Integer</span> genderCode <span class="token operator">=</span> person<span class="token punctuation">.</span><span class="token function">getGenderCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">GenderEnum</span> gender <span class="token operator">=</span> genderMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>genderCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
        person<span class="token punctuation">.</span><span class="token function">setGenderName</span><span class="token punctuation">(</span>gender<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>listPerson</code> 接口中的第 2、3 步就是非常典型的数据填充操作。</p> <h2 id="_2-用-crane4j-怎么做"><a href="#_2-用-crane4j-怎么做" class="header-anchor">#</a> 2.用 crane4j 怎么做？</h2> <p>当引入 crane4j 后，我们可以通过相对简洁的注解描述上述操作，并将此逻辑从主业务流程中剥离，以便让开发者更加集中于核心业务逻辑的开发：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@AutoOperate</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> <span class="token function">listPerson</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> ids<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> personMapper<span class="token punctuation">.</span><span class="token function">listByIds</span><span class="token punctuation">(</span>ids<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@AssembleEnum</span><span class="token punctuation">(</span>
        type <span class="token operator">=</span> <span class="token class-name">GenderEnum</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> enumKey <span class="token operator">=</span> <span class="token string">&quot;code&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 指定枚举类，并按字典值分组</span>
        props <span class="token operator">=</span> <span class="token annotation punctuation">@Mapping</span><span class="token punctuation">(</span>src <span class="token operator">=</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> ref <span class="token operator">=</span> <span class="token string">&quot;genderName&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 将枚举的 name 映射到 foo 的 genderName 属性</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> genderCode<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> genderName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>等到方法调用后，crane4j 将会自动的完成填充，效果与执行之前的代码完全一致。</p> <h2 id="_3-为什么需要-crane4j"><a href="#_3-为什么需要-crane4j" class="header-anchor">#</a> 3.为什么需要 crane4j？</h2> <p><strong>字段填充是一个广泛存在的需求，而 crane4j 则是针对它的一套完善的解决方案。</strong></p> <p>crane4j 有着详细的注释和文档，完善的测试用例，灵活而直观的 API，通过引入 crane4j，你可以在避免“重复造轮子”的前提下，通过更少的代码搞定各种数据填充的需求。并且，你还可以通过 crane4j 处理比示例更复杂的各种情况，包括且不限于下述场景：</p> <ul><li><strong>同时存在的复数操作</strong>：可能同时有多种类型的数据需要填充，比如各种详情页中，我们可能需要填充大量的关联数据；</li> <li><strong>复杂的数据结构</strong>：填充的对象可能是一个嵌套的树形结构，需要递归的填充嵌套的数据；</li> <li><strong>繁多的数据源</strong>：填充的数据源可能多种多样，比如有的通过 RPC 接口获取，有的通过 ORM 框架获取，有的则从本地缓存中获取；</li> <li><strong>可选的字段填充</strong>：相同的数据源在不同的场景下填充的字段可能不同，比如同样是用户查询接口，当对外展示时则需要屏蔽一些敏感信息，比如身份证号、权限等级等等；</li> <li><strong>异步填充</strong>：出于效率考虑，在数据源需要通过频繁的网络 IO 查询时，我们可能会希望异步的完成数据填充；</li></ul> <p>你所面临的场景越多样化，那么 crane4j 就可能能够带给你越多的便利。</p> <h2 id="_4-如何开始使用"><a href="#_4-如何开始使用" class="header-anchor">#</a> 4.如何开始使用？</h2> <p>如果你是第一次接触此类框架的新用户，那么推荐你先阅读 “<strong>基本概念</strong>” 建立对框架的初步认知，然后跟着 “<strong>快速开始</strong>” 一节尝试在本地编写一个可运行的最小示例，最后再根据情况继续阅读 “<strong>场景示例</strong>” 或其他内容。</p> <p>如果你已经使用过类似的框架，你可以直接阅读 “<strong>快速开始</strong>”，然后根据需要阅读后续的 “<strong>场景示例</strong>” 即可。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/crane4j/user_guide/basic_concept.html">
        基本概念
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/crane4j/assets/js/app.431d2ea9.js" defer></script><script src="/crane4j/assets/js/2.c1e52383.js" defer></script><script src="/crane4j/assets/js/8.f25e37d4.js" defer></script>
  </body>
</html>
