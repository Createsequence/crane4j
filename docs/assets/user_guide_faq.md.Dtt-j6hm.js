import{_ as e,c as a,o,a4 as r}from"./chunks/framework.CTZgbW0d.js";const m=JSON.parse('{"title":"FAQ","description":"","frontmatter":{},"headers":[],"relativePath":"user_guide/faq.md","filePath":"user_guide/faq.md","lastUpdated":1713973808000}'),t={name:"user_guide/faq.md"},d=r('<h1 id="faq" tabindex="-1">FAQ <a class="header-anchor" href="#faq" aria-label="Permalink to &quot;FAQ&quot;">​</a></h1><p>以下是一些常见问题与对应的解决方案。如果当你遇到问题时，可以先尝试在这里寻找解决方案。</p><h2 id="填充不生效" tabindex="-1">填充不生效？ <a class="header-anchor" href="#填充不生效" aria-label="Permalink to &quot;填充不生效？&quot;">​</a></h2><ul><li>确认在 <code>@AssembleXXX</code> 注解中正确配置了 <code>container</code> 与 <code>prop</code> / <code>props</code> 属性；</li><li>确认操作涉及的属性存在，且都有相应的 <code>setter</code> 和 <code>getter</code> 方法；</li><li>确认目标对象对应的 key 属性值不为空；</li><li>确认指定的数据源容器确实有根据 key 值列表返回非空集合；</li><li>确认通过 <code>BeanOperationParser</code> 解析类后，得到的 <code>BeanOperations</code> 中的 <code>AssembleOperation</code> 列表中有该 key 属性对应的操作配置；</li></ul><p>当确认上述步骤皆无问题后，你可以尝试在源码中 <code>cn.crane4j.core.executor.handler.AbstractAssembleOperationHandler</code> 类的 <code>doProcess</code> 方法中添加断点：</p><ul><li>如果未进入断点，则说明该操作配置未能生效，请重新确认上述原因；</li><li>进入 <code>collectToEntities</code>：在这一步，确认你填充的对象是否都已经被收集到，且 key 值被正确地获取；</li><li>进入 <code>getSourcesFromContainer</code>：在这一步，确认通过上述 key 值能够正确的从数据源获取到数据；</li><li>进入 <code>getTheAssociatedSource</code>：在这一步，确认待填充的对象可以通过 key 值获得相应的数据源对象；</li><li>进入 <code>completeMapping</code>：在这一步，确认 crane4j 是否按你的配置正确的将数据源对象的属性值映射到待填充的对象上；</li></ul><p>如果仍然无法解决，可以在 issues 中或者相关交流群中反馈。</p><h2 id="如何实现嵌套填充" tabindex="-1">如何实现嵌套填充？ <a class="header-anchor" href="#如何实现嵌套填充" aria-label="Permalink to &quot;如何实现嵌套填充？&quot;">​</a></h2><p>在需要嵌套填充的属性上添加 <code>@Disassemble</code> 注解即可，具体参见 <a href="./../basic/declare_disassemble_operation.html">填充嵌套对象</a>。</p><h2 id="如何实现级联填充" tabindex="-1">如何实现级联填充？ <a class="header-anchor" href="#如何实现级联填充" aria-label="Permalink to &quot;如何实现级联填充？&quot;">​</a></h2><p>参见 <a href="./../use_case/example_fill_relations.html">示例：如何级联填充</a> 一节。</p><h2 id="如何处理一对多的情况" tabindex="-1">如何处理一对多的情况？ <a class="header-anchor" href="#如何处理一对多的情况" aria-label="Permalink to &quot;如何处理一对多的情况？&quot;">​</a></h2><p>通过 <code>@AssembleXXX</code> 注解中的 <code>handler</code> 或 <code>handlerType</code> 属性指定装配处理器为一对多装配处理器 <code>OneToManyAssembleOperationHandler</code> 类型或名称（在 Spring 中即为 bean 名称）即可。</p><p>具体参见 <a href="./../basic/assemble_operation_handler.html">一对多&amp;多对多</a> 中一对多装配一节。</p><h2 id="键字段可以是按分隔符拼接的字符串吗" tabindex="-1">键字段可以是按分隔符拼接的字符串吗？ <a class="header-anchor" href="#键字段可以是按分隔符拼接的字符串吗" aria-label="Permalink to &quot;键字段可以是按分隔符拼接的字符串吗？&quot;">​</a></h2><p>通过 <code>@AssembleXXX</code> 注解中的 <code>handler</code> 或 <code>handlerType</code> 属性指定装配处理器为一对多装配处理器 <code>ManyToManyAssembleOperationHandler</code> 的类型或名称（在 Spring 中即为 bean 名称）即可。</p><p>具体参见 <a href="./../basic/assemble_operation_handler.html">一对多&amp;多对多</a> 中多对多装配一节。</p><h2 id="键字段可以是集合或数组吗" tabindex="-1">键字段可以是集合或数组吗？ <a class="header-anchor" href="#键字段可以是集合或数组吗" aria-label="Permalink to &quot;键字段可以是集合或数组吗？&quot;">​</a></h2><p>同上，通过 <code>@AssembleXXX</code> 注解中的 <code>handler</code> 或 <code>handlerType</code> 属性指定装配处理器为一对多装配处理器 <code>ManyToManyAssembleOperationHandler</code> 的类型或名称（在 Spring 中即为 bean 名称）即可。</p><p>具体参见 <a href="./../basic/assemble_operation_handler.html">一对多&amp;多对多</a> 中多对多装配一节。</p><h2 id="为什么使用异步执行器的时候报错" tabindex="-1">为什么使用异步执行器的时候报错？ <a class="header-anchor" href="#为什么使用异步执行器的时候报错" aria-label="Permalink to &quot;为什么使用异步执行器的时候报错？&quot;">​</a></h2><p>默认情况下，并没有注册异步操作执行器 <code>AsyncBeanOperationExecutor</code>，用户需要自行创建后再将其注册到全局配置中。</p><p>具体参见 <a href="./../user_guide/basic_concept.html">基本概念</a> 中异步执行器一节。</p><h2 id="怎么刷新容器的数据" tabindex="-1">怎么刷新容器的数据 ？ <a class="header-anchor" href="#怎么刷新容器的数据" aria-label="Permalink to &quot;怎么刷新容器的数据 ？&quot;">​</a></h2><ul><li>如果容器是 <code>ConstantContainer</code> ，直接通过 <code>get</code> 方法获取缓存的 <code>Map</code> 集合后直接修改即可；</li><li>获取 <code>Crane4jGlobalConfiguration</code> 或 <code>ContainerManager</code> 后，通过 <code>registerContainer</code> 使用命名空间相同的容器对旧容器进行覆盖；</li></ul><h2 id="怎么忽略掉某些字段不进行填充" tabindex="-1">怎么忽略掉某些字段不进行填充？ <a class="header-anchor" href="#怎么忽略掉某些字段不进行填充" aria-label="Permalink to &quot;怎么忽略掉某些字段不进行填充？&quot;">​</a></h2><p>参见 <a href="./../use_case/example_exclude_operation.html">示例：如何在执行时排除某一些操作</a> 一节。</p><h2 id="为什么-containermethod-注解不生效" tabindex="-1">为什么 <code>@ContainerMethod</code> 注解不生效？ <a class="header-anchor" href="#为什么-containermethod-注解不生效" aria-label="Permalink to &quot;为什么 `@ContainerMethod` 注解不生效？&quot;">​</a></h2><p>如果是非 Spring 环境，则需要手动的通过 <code>ContainerMethodAnnotationProcessor</code> 扫描指定类并向全局配置注册扫描获取的方法容器。</p><p>如果是 Spring 环境，请确保：</p><ul><li>容器中存在 <code>BeanMethodContainerRegistrar</code> 后处理器；</li><li>被注解的方法所在类被 Spring 扫描，且容器中存在对应的 bean；</li><li>被注解的方法所在类在 <code>BeanMethodContainerRegistrar</code> 后处理器初始化后才加载；</li></ul><h2 id="为什么-autooperate-注解不生效" tabindex="-1">为什么 <code>@AutoOperate</code> 注解不生效？ <a class="header-anchor" href="#为什么-autooperate-注解不生效" aria-label="Permalink to &quot;为什么 `@AutoOperate` 注解不生效？&quot;">​</a></h2><p>如果是非 Spring 环境，则需要手动的通过 <code>MethodArgumentAutoOperateSupport</code> 和 <code>MethodResultAutoOperateSupport</code> 拦截方法调用。</p><p>如果是 Spring 环境，请确保：</p><ul><li>开启了 <code>SpringAOP</code> 功能；</li><li>容器中存在 <code>MethodResultAutoOperateAdvisor</code> 或 <code>MethodArgumentAutoOperateAdvisor</code> 通知器；</li><li>被注解的方法所在类被 Spring 扫描、容器中存在对应的 bean 且被 Spring 代理；</li></ul><h2 id="为什么引了-guava-和-hutool" tabindex="-1">为什么引了 guava 和 hutool ？ <a class="header-anchor" href="#为什么引了-guava-和-hutool" aria-label="Permalink to &quot;为什么引了 guava 和 hutool ？&quot;">​</a></h2><p>不想要重复造轮子，有些组件直接使用成熟的开源库比自己再写一套更可靠。</p><p>此外，<code>crane4j</code> 仅在有限的地方使用了这些工具类库：</p><ul><li><code>guava</code> ：使用了缓存组件 <code>Cache</code> 与用于构造 <code>WeakConcurrentMap</code> 的 <code>MapMaker</code>；</li><li><code>hutool</code>：使用了类型转换取组件 <code>Convert</code>，如果没用到 <code>HutoolConverterManager</code> 可以在依赖中排除；</li></ul><h2 id="支持-jdk9-springboot3-吗" tabindex="-1">支持 jdk9+ / springboot3 吗？ <a class="header-anchor" href="#支持-jdk9-springboot3-吗" aria-label="Permalink to &quot;支持 jdk9+ / springboot3 吗？&quot;">​</a></h2><p>支持。</p><h2 id="容器可以做一些自定义的初始化-销毁操作吗" tabindex="-1">容器可以做一些自定义的初始化/销毁操作吗？ <a class="header-anchor" href="#容器可以做一些自定义的初始化-销毁操作吗" aria-label="Permalink to &quot;容器可以做一些自定义的初始化/销毁操作吗？&quot;">​</a></h2><p>实现 <code>Container.Lifecycle</code> 接口即可，具体参见 <a href="./../advanced/callback_of_component.html">容器的生命周期</a>。</p><h2 id="可以支持同时根据多个-key-字段填充数据吗" tabindex="-1">可以支持同时根据多个 key 字段填充数据吗？ <a class="header-anchor" href="#可以支持同时根据多个-key-字段填充数据吗" aria-label="Permalink to &quot;可以支持同时根据多个 key 字段填充数据吗？&quot;">​</a></h2><p>可以，具体参照 <a href="./../use_case/example_multi_key.html">示例：如何通过多个Key关联数据</a>。</p><h2 id="启动应用报错-no-servletcontext-set" tabindex="-1">启动应用报错 “No ServletContext set” <a class="header-anchor" href="#启动应用报错-no-servletcontext-set" aria-label="Permalink to &quot;启动应用报错 “No ServletContext set”&quot;">​</a></h2><p>在 2.4.0 及更早的版本中，当你在 web 环境中通过 <code>@EnableCrane4j</code> 注解引入框架后，启动项目有可能会出现 “No ServletContext set” 问题，关于该问题的解决方案参见：<a href="https://github.com/opengoofy/crane4j/issues/126" target="_blank" rel="noreferrer">在启动类添加 <code>@EnableCrane4j</code> 注解后，启动应用报错 “No ServletContext set”</a>。</p><p>你可以直接升级 crane4j 到 2.5.0 或更高版本解决这个问题。</p><h2 id="可以多线程填充吗" tabindex="-1">可以多线程填充吗？ <a class="header-anchor" href="#可以多线程填充吗" aria-label="Permalink to &quot;可以多线程填充吗？&quot;">​</a></h2><p>你可以通过在手动或自动装配时指定使用异步执行器来实现多线程填充的效果，具体参见：</p><ul><li><a href="./basic_concept.html">基本概念-操作执行器</a>；</li><li><a href="./../basic/trigger_operation.html">触发填充操作-指定执行器</a>；</li></ul>',51),c=[d];function l(i,n,h,s,p,u){return o(),a("div",null,c)}const _=e(t,[["render",l]]);export{m as __pageData,_ as default};
